<!DOCTYPE html>
<html>
<head>
<title>browser ast demo</title>
</head>
<body>
	
<script src="https://weizhenwei.github.io/demoPage/ast/escodegen.browser.2.0.0.js"></script>
<script src="https://weizhenwei.github.io/demoPage/ast/estraverse.browser.5.2.0.js"></script>
<script src="https://weizhenwei.github.io/demoPage/ast/esprima.browser.4.0.1.js"></script>
<script src="https://weizhenwei.github.io/demoPage/ast/acorn.browser.8.4.1.js"></script>
	
<P>source code:</p>
<div>
<textarea id="srcArea" style="width:400px; height:300px;">
import ('https://static01.nyt.com/newsgraphics/2021/08/25/right-rail-header/b2d5c97936aa7e89d7b351d41f2bf789cbc5f44d/build/js/freebird.js');

var a = 1 + 1;
console.log(a);
</textarea>
</div>

<button id="parseCode">parse code</button>

<P>paresed code:</p>

<div>
<textarea id="dstArea" style="width:400px; height:300px;">
</textarea>
</div>
	
<script type="text/javascript">
window.onload = function() {
    var srcBtn = document.getElementById('parseCode');
    srcBtn.addEventListener('click', function (e) {
        var srcCode = document.getElementById('srcArea').value;
	console.log("sourceJS:", srcCode);

	// let ast = esprima.parseScript(srcCode, {
        //   jsx: false,
        //   range: false,
        //   loc: false,
        //   tolerant: true,
        //   tokens: false,
        //   comment: false
	// })
	// console.log("esprima ast:", ast);

        let ast = acorn.parse(srcCode, {ecmaVersion: 2020})
        console.log("acorn ast:", ast);

	estraverse.replace(ast, {
	  leave(node, parent) {
		console.log("node in traverse:", node);
	  }
	});
	console.log("estraverse ast:", ast);

	let sourceOutput = escodegen.generate(ast, {
          format: escodegen.FORMAT_MINIFY
	});
	console.log("escodegen output:", sourceOutput);

	var dstCode = document.getElementById('dstArea');
	dstCode.value=sourceOutput;
    });
}

</script>
</body>
</html>
